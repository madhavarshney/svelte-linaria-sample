# svelte-linaria-sample

This repo shows how to use the CSS-in-JS library [`linaria`](https://linaria.now.sh/) with [Svelte](https://svelte.dev/) v3.

## Contents
- [Svelte with Rollup](/#Rollup)
- [Svelte with Webpack](/#Webpack)
- [Contributing](/#Contributing)

## Rollup

### Running the sample

Install the dependencies...

```bash
cd svelte-rollup
npm install
```

...then start [Rollup](https://rollupjs.org):

```bash
npm run dev
```

Navigate to [localhost:5000](http://localhost:5000).

### Adding to a project

Take a look: [d964432](https://github.com/madhavarshney/svelte-linaria-sample/commit/d96443218694c0c8d80edf7c40a8fbf7c1f6997f)

Install `linaria` and `rollup-plugin-css-only`:

```sh
npm install -D linaria rollup-plugin-css-only
# OR
yarn add --dev linaria rollup-plugin-css-only
```

Update `rollup.config.js`

```js
import svelte from 'rollup-plugin-svelte';
import css from 'rollup-plugin-css-only'; // for CSS bundling
import linaria from 'linaria/rollup';

const dev = process.env.NODE_ENV !== 'production';

export default {
  ...
  plugins: [
    svelte({
      dev,
      // allow `plugin-css-only` to bundle with CSS generated by linaria
      emitCss: true,
    }),
    linaria({
      sourceMap: dev,
    }),
    css({
      output: '<OUT_FOLDER>/bundle.css',
    }),
  ],
};
```

**IMPORTANT**: `rollup-plugin-css-only` generates incorrect sourcemaps (see [thgh/rollup-plugin-css-only#10](https://github.com/thgh/rollup-plugin-css-only/issues/10)). Use an alternative CSS plugin such as `rollup-plugin-postcss` instead in the same way as above.

## Webpack

### Running the sample

Install the dependencies...

```bash
cd svelte-webpack
npm install
```

...then start webpack:

```bash
npm run dev
```

Navigate to [localhost:8080](http://localhost:8080).

### Adding to a project

Take a look: [5ffd69d](https://github.com/madhavarshney/svelte-linaria-sample/commit/5ffd69dc9f9584e3eec4127e798d7a4c1552ec19)

Install `linaria`:

```sh
npm install -D linaria
# OR
yarn add --dev linaria
```

Update `webpack.config.js`:

```js
const prod = process.env.NODE_ENV === 'production';

const linariaLoader = {
  loader: 'linaria/loader',
  options: {
    sourceMap: !prod,
    cacheDirectory: path.resolve(__dirname, 'node_modules/.cache/.linaria-cache')
  }
};

module.exports = {
  ...
  module: {
    rules: [
      {
        test: /\.m?js$/,
        exclude: /node_modules/,
        use: [linariaLoader]
      },
      {
        test: /\.svelte$/,
        use: [
          linariaLoader,
          {
            loader: 'svelte-loader',
            options: {
              dev: !prod,
              emitCss: true,
              hotReload: true
            }
          }
        ]
      },
      ...(CSS rules)
    ]
  }
}
```

## Contributing
All contributions are welcome. Please open an issue or PR if there's something that can be fixed.

_Also, consider starring ‚≠ê this repo if it helped you!_

## License
The code in this repo is licensed under the MIT license.
